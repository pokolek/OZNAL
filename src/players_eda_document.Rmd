
---
title: "Exploratory Data Analysis of Soccer Players Dataset"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(corrplot)
# If needed, install additional libraries like ggplot2, dplyr, corrplot
```

## Load and Inspect the Dataset

```{r load-inspect}
players <- read.csv("C:/Users/marti/OneDrive/Documents/OZNAL/OZNAL/data/players_22.csv")
glimpse(players) # Provides a brief overview of the dataset
summary(players) # Summarizes the data giving quick insights
```

## Data Cleaning

Identify and handle missing values, outliers, and possibly convert data types as needed.

```{r data-cleaning}
players <- players %>% 
  filter(!is.na(overall)) # Example: Removing rows with missing 'overall' ratings
```

## Distribution of Key Variables

Plot the distribution of player attributes like age, overall, potential, etc.

```{r distribution}
ggplot(players, aes(x=age)) + geom_histogram(bins=30) + theme_minimal() + ggtitle("Distribution of Player Ages")
```

## Relationship Between Variables

Explore relationships, e.g., between a player's overall rating and their value_eur.

```{r relationships - overall}
ggplot(players, aes(x=overall, y=value_eur)) + geom_point() + theme_minimal() + ggtitle("Overall Rating vs. Market Value")
```

Players potential and his value
```{r relationships - potential}
ggplot(players, aes(x=potential, y=value_eur)) + geom_point() + theme_minimal() + ggtitle("Potential vs. Market Value")
```

Players age and his value
```{r relationships - age}
ggplot(players, aes(x=age, y=value_eur)) + geom_point() + theme_minimal() + ggtitle("Age vs. Market Value")
```

Players international reputation and his value
```{r relationships - international reputation}
ggplot(players, aes(x=international_reputation, y=value_eur)) + geom_point() + theme_minimal() + ggtitle("International reputation vs. Market Value")
```


```{r Histograms for Skill Attributes by Position}
players_simplified <- players %>%
  mutate(primary_position = str_split(player_positions, ",", simplify = TRUE)[,1])

# Histograms for Skill Attributes by Primary Position
players_simplified %>%
  gather(key="skill", value="value", pace, shooting, passing, dribbling, defending, physic) %>%
  mutate(skill = factor(skill)) %>%
  ggplot(aes(x=value, fill=primary_position)) + 
  geom_histogram(bins=20, alpha=0.5, position="identity") + 
  facet_wrap(~skill, scales="free_x") +
  theme_minimal() +
  theme(legend.position="bottom") +
  labs(title="Distribution of Skill Attributes by Primary Player Positions", x="Attribute Value", y="Frequency")

```

## Comparisons and Aggregations

Compare distributions or mean values across different groups, like comparing average overall ratings by league_name or nationality_name.

```{r comparisons-aggregations}
players %>%
  group_by(league_name) %>%
  summarise(Avg_Overall = max(overall, na.rm = TRUE)) %>%
  arrange(desc(Avg_Overall)) %>%
  head(10) %>% # Top 10 leagues by average player rating
  ggplot(aes(x=reorder(league_name, Avg_Overall), y=Avg_Overall)) +
  geom_bar(stat="identity") +
  coord_flip() +
  theme_minimal() +
  ggtitle("Top 10 Leagues by Average Player Rating")
```

## Explore Correlations

Investigate correlations between numerical attributes to identify potential relationships.

```{r correlations}
players$value_eur <- as.numeric(gsub("[^0-9.-]", "", players$value_eur))
players$wage_eur <- as.numeric(gsub("[^0-9.-]", "", players$wage_eur))
players <- players %>%
  filter(!is.na(value_eur), !is.na(wage_eur))
summary(players$value_eur)
summary(players$wage_eur)

correlation_matrix <- cor(select(players, overall, potential, value_eur, age, wage_eur))
corrplot(correlation_matrix, method = "circle") # Note: Ensure 'corrplot' package is installed
```

## Regression
## Hypoteza: Hodnota value_eur vie byt predpovedana pomocou kombinacia atributov:overall, potential, age a international_reputation

## Regression - Linear Regression, Random Forest Regressor, or Gradient Boosting Regressor.

## Evaluation - RMSE and R^2

```

```

## Classification
## Hypoteza: Atribut player_positions vie byt klasifikovany na zaklade fyzickych atributov ako: height_cm, weight_kg a technickych atributov: pace, shooting, dribbling, defending, physic

## Classification - Logistic Regression, K-Nearest Neighbors, Random Forest Classifier, or Support Vector Machines

## Evaluation - Accuracy, precision, recall, F1 score, confusion matrice

```

```




