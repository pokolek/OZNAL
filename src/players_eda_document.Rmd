
---
title: "Exploratory Data Analysis of Soccer Players Dataset"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(corrplot)
library(ggplot2)
# If needed, install additional libraries like ggplot2, dplyr, corrplot
```

## Load and Inspect the Dataset

```{r load-inspect}
players <- read.csv("C:/Users/marti/OneDrive/Documents/OZNAL/OZNAL/data/players_22.csv")
glimpse(players) # Provides a brief overview of the dataset
summary(players) # Summarizes the data giving quick insights
```

## Data Cleaning

Remove players, that play as a goalkeeper

```{r}
players <- players %>% 
  filter(!str_detect(player_positions, "GK")) 
```

```{r}
# Selecting specific columns for the pair plot
selected_columns <- players[, c("value_eur", "potential", "overall", "age", "wage_eur", "height_cm", "weight_kg", "league_level", "club_contract_valid_until", "nation_team_id", "release_clause_eur", "skill_moves", "pace", "shooting", "passing", "dribbling", "defending", "physic")]

# Removing rows with NA values to ensure the plot works correctly
selected_columns_clean <- na.omit(selected_columns)

# Plot value_eur vs potential
ggplot(selected_columns_clean, aes(x = potential, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. potential", x = "Potential", y = "Market Value (EUR)")

# Plot value_eur vs overall
ggplot(selected_columns_clean, aes(x = overall, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. overall", x = "Overall Rating", y = "Market Value (EUR)")

# Plot value_eur vs age
ggplot(selected_columns_clean, aes(x = age, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. age", x = "Age", y = "Market Value (EUR)")

# Plot value_eur vs wage_eur
ggplot(selected_columns_clean, aes(x = wage_eur, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. wage_eur", x = "wage_eur", y = "Market Value (EUR)")

# Plot value_eur vs height_cm
ggplot(selected_columns_clean, aes(x = height_cm, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. height_cm", x = "height_cm", y = "Market Value (EUR)")

# Plot value_eur vs weight_kg
ggplot(selected_columns_clean, aes(x = weight_kg, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. weight_kg", x = "weight_kg", y = "Market Value (EUR)")

# Plot value_eur vs league_level
ggplot(selected_columns_clean, aes(x = league_level, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. league_level", x = "league_level", y = "Market Value (EUR)")

# Plot value_eur vs club_contract_valid_until
ggplot(selected_columns_clean, aes(x = club_contract_valid_until, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. club_contract_valid_until", x = "club_contract_valid_until", y = "Market Value (EUR)")

# Plot value_eur vs nation_team_id
ggplot(selected_columns_clean, aes(x = nation_team_id, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. nation_team_id", x = "nation_team_id", y = "Market Value (EUR)")

# Plot value_eur vs release_clause_eur
ggplot(selected_columns_clean, aes(x = release_clause_eur, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. release_clause_eur", x = "release_clause_eur", y = "Market Value (EUR)")

# Plot value_eur vs skill_moves
ggplot(selected_columns_clean, aes(x = skill_moves, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. skill_moves", x = "skill_moves", y = "Market Value (EUR)")

# Plot value_eur vs pace
ggplot(selected_columns_clean, aes(x = pace, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. pace", x = "pace", y = "Market Value (EUR)")

# Plot value_eur vs shooting
ggplot(selected_columns_clean, aes(x = shooting, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. shooting", x = "shooting", y = "Market Value (EUR)")

# Plot value_eur vs passing
ggplot(selected_columns_clean, aes(x = passing, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. passing", x = "passing", y = "Market Value (EUR)")

# Plot value_eur vs dribbling
ggplot(selected_columns_clean, aes(x = dribbling, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. dribbling", x = "dribbling", y = "Market Value (EUR)")

# Plot value_eur vs defending
ggplot(selected_columns_clean, aes(x = defending, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. defending", x = "defending", y = "Market Value (EUR)")

# Plot value_eur vs physic
ggplot(selected_columns_clean, aes(x = physic, y = value_eur)) + 
  geom_point() + 
  theme_minimal() + 
  labs(title = "value_eur vs. physic", x = "physic", y = "Market Value (EUR)")
```


Identify and handle missing values, outliers, and possibly convert data types as needed.

```{r data-cleaning}
players <- players %>% 
  filter(!is.na(overall)) # Example: Removing rows with missing 'overall' ratings
```

## Distribution of Key Variables

Plot the distribution of player attributes like age, overall, potential, etc.

```{r distribution}
ggplot(players, aes(x=age)) + geom_histogram(bins=30) + theme_minimal() + ggtitle("Distribution of Player Ages")
```

## Relationship Between Variables

Explore relationships, e.g., between a player's overall rating and their value_eur.

```{r relationships - overall}
ggplot(players, aes(x=overall, y=value_eur)) + geom_point() + theme_minimal() + ggtitle("Overall Rating vs. Market Value")
```

Players potential and his value
```{r relationships - potential}
ggplot(players, aes(x=potential, y=value_eur)) + geom_point() + theme_minimal() + ggtitle("Potential vs. Market Value")
```

Players age and his value
```{r relationships - age}
ggplot(players, aes(x=age, y=value_eur)) + geom_point() + theme_minimal() + ggtitle("Age vs. Market Value")
```

Players international reputation and his value
```{r relationships - international reputation}
ggplot(players, aes(x=international_reputation, y=value_eur)) + geom_point() + theme_minimal() + ggtitle("International reputation vs. Market Value")
```


```{r Histograms for Skill Attributes by Position}
players_simplified <- players %>%
  mutate(primary_position = str_split(player_positions, ",", simplify = TRUE)[,1])

# Histograms for Skill Attributes by Primary Position
players_simplified %>%
  gather(key="skill", value="value", pace, shooting, passing, dribbling, defending, physic) %>%
  mutate(skill = factor(skill)) %>%
  ggplot(aes(x=value, fill=primary_position)) + 
  geom_histogram(bins=20, alpha=0.5, position="identity") + 
  facet_wrap(~skill, scales="free_x") +
  theme_minimal() +
  theme(legend.position="bottom") +
  labs(title="Distribution of Skill Attributes by Primary Player Positions", x="Attribute Value", y="Frequency")

```

## Comparisons and Aggregations

Compare distributions or mean values across different groups, like comparing average overall ratings by league_name or nationality_name.

```{r comparisons-aggregations}
players %>%
  group_by(league_name) %>%
  summarise(Avg_Overall = max(overall, na.rm = TRUE)) %>%
  arrange(desc(Avg_Overall)) %>%
  head(10) %>% # Top 10 leagues by average player rating
  ggplot(aes(x=reorder(league_name, Avg_Overall), y=Avg_Overall)) +
  geom_bar(stat="identity") +
  coord_flip() +
  theme_minimal() +
  ggtitle("Top 10 Leagues by Average Player Rating")
```

## Explore Correlations

Investigate correlations between numerical attributes to identify potential relationships.

```{r correlations}
players$value_eur <- as.numeric(gsub("[^0-9.-]", "", players$value_eur))
players$wage_eur <- as.numeric(gsub("[^0-9.-]", "", players$wage_eur))
players <- players %>%
  filter(!is.na(value_eur), !is.na(wage_eur))
summary(players$value_eur)
summary(players$wage_eur)

correlation_matrix <- cor(select(players, overall, potential, value_eur, age, wage_eur))
corrplot(correlation_matrix, method = "circle") # Note: Ensure 'corrplot' package is installed
```

## Regression
## Hypoteza: Hodnota value_eur vie byt predpovedana pomocou kombinacia atributov:overall, potential, wage_eur

## Regression - Linear Regression, Random Forest Regressor, or Gradient Boosting Regressor.

## Evaluation - RMSE and R^2

```

```

## Classification
## Hypoteza: Atribut player_positions vie byt klasifikovany na zaklade fyzickych atributov ako: height_cm, weight_kg a technickych atributov: pace, shooting, dribbling, defending, physic

## Classification - Logistic Regression, K-Nearest Neighbors, Random Forest Classifier, or Support Vector Machines

## Evaluation - Accuracy, precision, recall, F1 score, confusion matrice

```

```




